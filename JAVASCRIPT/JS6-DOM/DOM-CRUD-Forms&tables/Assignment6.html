<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        input[type="text"] {
            width: 273px;
        }

        input#Raju12 {
            width: 210px;
        }

        input#Raju {
            width: 51px;
        }

        input[type="number"] {
            width: 273px;
        }

        button#Sai {
            margin-left: 216px;
            width: 62px;
        }

        td {
            color: red;
            background-color: yellow;
            text-align: center;
        }

        th {
            color: white;
            background-color: black;
        }
    </style>
</head>

<body>
    <div id="chinjna">
        <form action="">
            <h2>Address</h2>
            <hr>
            <label for="Street">Street:</label><br>
            <input type="text" name="Street" id="Street" onkeyup="validate()"><br><br>


            <label for="CityState">City,State :</label><br><br>
            <input type="text" name="" id="CityState" onkeyup="validate()"><br><br>


            <label for="ZipCode ">Zip Code :</label><br><br>
            <input type="number" name="" id="ZipCode" onkeyup="validate()"><br><br>

            <label for="Country">Country:</label><br><br>
            <input type="text" name="Country" id="Country" onkeyup="validate()"><br><br>

            <button type="button" id="Adduser" onclick="AddUser()" disabled>Ok</button>
            <!-- <Button type="button" onclick=" clearsearch()">Cancel</Button> -->
            <Button type="button" id="updateuser" onclick=" updateusers()" style="display: none">updateuser</Button>
        </form>
    </div><br><br>
    <table border="1" style="width:50%">
        <thead>
            <th>Street</th>
            <th>City,State </th>
            <th>Zip Code </th>
            <th>Country</th>
            <th>Edit</th>
            <th>Delete</th>
        </thead>
        <tbody>

        </tbody>
    </table>
    <script>
        var allUsers = JSON.parse(localStorage.getItem("allUsers"))
        var index=null
        if (allUsers == null) {
            allUsers = []
        }
        function AddUser() {
            var users = {
                Street: document.getElementById("Street").value,
                CityState: document.getElementById("CityState").value,
                ZipCode: document.getElementById("ZipCode").value,
                Country: document.getElementById("Country").value
            }
            allUsers.push(users)

            localStorage.setItem("allUsers", JSON.stringify(allUsers))

            console.log(users)
            document.getElementById("Adduser").setAttribute("disabled", true)
            // console.log(allUsers)
            displayusers(allUsers)
            Clearform(users)

        }
        //   function clearsearch() {
        //         document.getElementById("Street").value = "";
        //         document.getElementById("CityState").value = "";
        //         document.getElementById("ZipCode").value = "";
        //         document.getElementById("Country").value = ""
        //     }

        function Clearform(users) {
            for (a in users) {
                document.getElementById(a).value = ""
            }
        }

        function displayusers() {
            document.querySelector("tbody").innerHTML = ""
            allUsers.forEach((user, i) => {
                var myTr = document.createElement("tr")
                for (a in user) {
                    var myTd = document.createElement("td")
                    myTd.innerHTML = user[a]
                    myTr.appendChild(myTd)
                }
                var editTd = document.createElement("td")
                var editbtn = document.createElement("button")
                editbtn.setAttribute("onclick", "edituser(" + i + ")")
                editbtn.innerHTML = "Edit"
                editTd.appendChild(editbtn)
                myTr.appendChild(editTd)

                var deleteTd = document.createElement("td")
                var deletebtn = document.createElement("button")
                deletebtn.setAttribute("onclick", "deleteuser(" + i + ")")
                deletebtn.innerHTML = "Delete"
                deleteTd.appendChild(deletebtn)
                myTr.appendChild(deleteTd)

                document.querySelector("tbody").appendChild(myTr)
            })

        }
        function edituser(i) {
            console.log(allUsers[i])
            index = i
            document.getElementById("Street").value = allUsers[i].Street
            document.getElementById("CityState").value = allUsers[i].CityState
            document.getElementById("ZipCode").value = allUsers[i].ZipCode
            document.getElementById("Country").value = allUsers[i]. Country 
            document.getElementById("Adduser").style.display="none"
            document.getElementById("updateuser").style.display="block"
            
}
        function deleteuser(i) {
            // console.log("Edit user Called"+i)
            allUsers.splice(i, 1)
            displayusers()
        }
        displayusers()

        function validate() {
            var users = {
                Street: document.getElementById("Street").value,
                CityState: document.getElementById("CityState").value,
                ZipCode: document.getElementById("ZipCode").value,
                Country: document.getElementById("Country").value
            }

            var cheak = false;
            for (a in users) {
                if (users[a] == "") {
                    cheak = true
                }
            }

            if (cheak == true) {
                document.getElementById("Adduser").setAttribute("disabled", true)
            }
            else {
                document.getElementById("Adduser").removeAttribute("disabled")
            }
        }
        function updateusers(){
            console.log("Update user called")
            var users = {
                Street: document.getElementById("Street").value,
                CityState: document.getElementById("CityState").value,
                ZipCode: document.getElementById("ZipCode").value,
                Country: document.getElementById("Country").value
            }
            allUsers[index]=users

            localStorage.setItem("allUsers", JSON.stringify(allUsers))

            displayusers(allUsers)
            Clearform(users)
            document.getElementById("Adduser").style.display="block"
            document.getElementById("updateuser").style.display="none"
        }
    </script>
</body>

</html>