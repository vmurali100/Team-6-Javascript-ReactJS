<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form action="">
        <label for="name">name</label><br>
        <input type="text" name="" id="name" onkeyup="validate()"/> <br /><br>
    
        <label for="date">date</label><br>
        <input type="date" name="" id="date" onkeyup="validate()"/> <br /><br>
    
        <label for="salary">salary</label><br>
        <input type="text" name="" id="salary" onkeyup="validate()"/> <br /><br>
    
        <label for="branch">branch</label><br>
        <input type="text" name="" id="branch" onclick="validate()">
        <br><br>
        <button type="button" id="addUser" onclick="addUser()" disabled>Add User</button>
        <button type="button" id="updateUser" onclick="updateUsers()" style="display:none">Update User</button>
      </form>
      <hr />
      <table border="1">
        <tr>
          <thead>
            <th>Name</th>
            <th>Date</th>
            <th>salary </th>
            <th>branch</th>
            <th>Edit</th>
            <th>Delete</th>
          </thead>
        </tr>
        <tbody></tbody>
      </table>
    
     <script>
    
        var allUsers = JSON.parse(localStorage.getItem("allUsers"));
        var index=null
        if (allUsers == null) {
          allUsers = [];
        }
        function addUser() {
          var user = {
            name: document.getElementById("name").value,
            date: document.getElementById("date").value,
            salary: document.getElementById("salary").value,
            branch: document.getElementById("branch").value,
          };
          allUsers.push(user);
    
          displayUsers(allUsers);
          clearForm();
        }
    
        function clearForm() {
          document.getElementById("name").value = "";
          document.getElementById("date").value = "";
          document.getElementById("salary").value = "";
          document.getElementById("branch").value = "";
        }
    
        function displayUsers(data) {
          document.querySelector("tbody").innerHTML = "";
          data.forEach((user,i) => {
            var myTr = document.createElement("tr");
            for (a in user) {
              var myTd = document.createElement("td");
              myTd.innerHTML = user[a];
              myTr.appendChild(myTd);
            }
    
            var editTd = document.createElement("td")
            var editBtn = document.createElement("button");
            editBtn.setAttribute("onclick","editUser("+i+")")
            editBtn.innerHTML = "Edit";
            editTd.appendChild(editBtn);
            myTr.appendChild(editTd)
    
            var deleteTd = document.createElement("td")
            var deleteBtn = document.createElement("button")
            deleteBtn.setAttribute("onclick","deleteUser("+i+")")
    
            deleteBtn.innerHTML="Delete";
            deleteTd.appendChild(deleteBtn)
            myTr.appendChild(deleteTd)
    
            document.querySelector("tbody").appendChild(myTr);
          });
        }
    
    
        function editUser(i){
          console.log("editUser called "+i)
    
        }
        function editUser(i){
        console.log(allUsers[i])
        index = i
        document.getElementById("name").value= allUsers[i].name
        document.getElementById("date").value= allUsers[i].date
        document.getElementById("salary").value= allUsers[i].salary
       document.getElementById("branch").value= allUsers[i].branch
       document.getElementById("addUser").style.display = "none"
        document.getElementById("updateUser").style.display = "block"
        
       
      }
    
        function deleteUser(i){
          allUsers.splice(i,1);
          displayUsers(allUsers)
        }
        displayUsers(allUsers);
    
    
        function validate(){
          var user = {
            name: document.getElementById("name").value,
            date: document.getElementById("date").value,
            salary: document.getElementById("salary").value,
            branch: document.getElementById("branch").value,
          };
    
          var check = false;
          for(a in user){
            if(user[a] == ""){
              check = true
            }
          }
    
          if(check == true){
            document.getElementById("addUser").setAttribute("disabled",true);
          }else{
            document.getElementById("addUser").removeAttribute("disabled");
          }
    
        }
        function updateUsers(){
        console.log("Update User Called")
        var user = {
          name: document.getElementById("name").value,
          date: document.getElementById("date").value,
          salary: document.getElementById("salary").value,
          branch: document.getElementById("branch").value,
        };

        allUsers[index] = user

        localStorage.setItem("allUsers", JSON.stringify(allUsers));

        displayUsers(allUsers);
        clearForm();
        document.getElementById("addUser").style.display = "block"
        document.getElementById("updateUser").style.display = "none"
      }
      </script>
</body>
</html>